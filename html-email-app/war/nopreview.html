<!--
#-------------------------------------------------------------------------------
# Copyright (c) 2013 takoyaki.ch.
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the GNU Public License v3.0
# which accompanies this distribution, and is available at
# http://www.gnu.org/licenses/gpl.html
# 
# Contributors:
#     takoyaki.ch - Initial version
#-------------------------------------------------------------------------------
 -->
<!doctype html>
<!-- The DOCTYPE declaration above will set the     -->
<!-- browser's rendering engine into                -->
<!-- "Standards Mode". Replacing this declaration   -->
<!-- with a "Quirks Mode" doctype is not supported. -->

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<link type="text/css" rel="stylesheet" href="nopreview.css">

<title>No Preview</title>

</head>
<body class="nopreview">
 <h1>Help</h1>
 This utility is meant to speed up development of html email templates by allowing rapid preview in both the preview
 pane and by downloading html and eml files that can be previewed in different browsers or mail clients respectively.

 <h2>Previewing</h2>
 <p>In order to preview a tab, double click on it, it will be highlighted and automatically previewed in this area
  as you type</p>

 <h2>Editing</h2>
 <p>Editing is organized with tabs click on "+" to create a new file.</p>
 <p>Each file is saved locally in your browser's files. Note if you use different browsers on different computers
  that each of them has a different set of files</p>

 <h2>XSLT</h2>
 <p>The editor supports xslt with a &lt;?xml-stylesheet type="text/xsl" href="styles_email.xsl"?&gt; declaration.
  the style sheet must be one of the open tabs and named correctly.</p>

 <h2>Postprocessing</h2>
 <p>As a last resort to transform the document a special file named __postprocessing.js can be created.</p>
 <p>This file can contain arbitrary javascript code but the entry points are the following functions:</p>
 <ul>
  <li>function before_save_eml(content)</li>
  <li>function before_save_html(content)</li>
  <li>function before_preview(content)</li>
 </ul>
 <p>They should return the transformed content e.g.</p>
 <pre>function before_preview(content) {
  return content;
 }
 </pre>

 <h2>Menus</h2>
 <h3>File</h3>
 <h4>Close</h4>
 <p>Closes the current tab. Note that the content of the tabs is lost if you close them.</p>
 <h4>Close all</h4>
 <p>Closes all tabs. Note that the content of the tabs is lost if you close them.</p>
 <h4>Open from file system</h4>
 <p>Let's you upload files from disk to the editor, you can select multiple files</p>
 <h4>Save as zip</h4>
 <p>Saves all open tabs in a zip file and downloads it</p>

 <h3>Export</h3>
 <h4>Single HTML</h4>
 <p>Will download the rendered content in the preview area as a single html file. The html can be used to review
  under different Browsers/Platforms. It will inline the css file if it is one of the open files.</p>

 <h4>EML</h4>
 <p>Use the Eml button to download a preview email file.</p>
 <p>This can then be used to preview on different email clients. Currently tested:</p>
 <dl>
  <dt>Thunderbird Mac 17</dt>
  <dd>
   Must be open when opening the eml file otherwise the eml is not loaded. Also to display external images in local eml
   files you will need to install the <a href="https://addons.mozilla.org/en-us/thunderbird/addon/viewabout/?src=search"
    target="_blank"
   >ViewAbout Addon</a>. Open View/ViewAbout/about:config from the menu. Search
   mailnews.message_display.disable_remote_image and set the value to false. The remote images are now loaded for EML
   files. Since this is a security setting don't forget to set it back to true when done.
  </dd>
  <dt>Outlook Mac 2011</dt>
  <dd>Works without restrictions</dd>
  <dt>Apple Mail 6.5</dt>
  <dd>Works without restrictions</dd>
  <dt>IBM Notes 9 Mac</dt>
  <dd>Works without restrictions</dd>
  <dt>Outlook 2007 SP3 Windows</dt>
  <dd>
   You might need to install registry keys: <a href="http://www.msoutlook.info/question/354">http://www.msoutlook.info/question/354</a>.
   Note that one of the service packs adds the eml feature, it is not present in an installation without service packs.
  </dd>
 </dl>
</body>
</html>
